(function(e,t){var a=e.G=typeof exports=="undefined"?{}:exports;a.version="0.0.6";var i=decodeURIComponent,s=encodeURIComponent,n=Array.isArray;var r=["href","protocol","origin","userInfo","username","password","hostname","port","relative","pathname","directory","file","search","hash"],o=["searchKey","searchList"],f=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,l=/(?:^|&)([^&=]*)=?([^&]*)/g,c=function(e){var t={toString:h,join:u,update:d},a=f.exec(e||""),s=14;while(s--)t[r[s]]=a[s]||"";var n=t[o[0]]={},c=t[o[1]]={};t[r[12]].replace(l,function(e,t,a){if(t){t=i(t);a=i(a);n[t]=a;(c[t]=c[t]||[]).push(a)}});return t},h=function(e){e=e||this;var t=e[r[1]]||"http",a=e[r[4]],i=e[r[5]],n=e[r[6]],f=e[r[7]],l=e[r[9]],c=e[r[12]],h=e[r[13]],u=e[o[0]],d=e[o[1]],p=n?[t,"://"]:[],g=[],m,v,y,w;if(a){p.push(a);if(i)p.push(":",i);p.push("@")}p.push(n);if(f)p.push(":",f);p.push(l||(n?"/":""));if(c){p.push("?",c)}else{if(u){for(m in u){g.push(s(m)+"="+s(u[m]))}}else if(d){for(m in d){for(y=0,v=d[m],w=v.length;y<w;y++){g.push(s(m)+"="+s(v[y]))}if(w===0)g.push(m)}}if(g.length)p.push("?",g.join("&"))}if(h)p.push("#",h);return p.join("")},u=function(e,t){t=t||{};var a=this,i=a[r[9]].split("/"),s=i.length-1,n=c(e),f=n.pathname.split("/"),l=f.length,h,u;if(typeof t.query=="undefined")t.query=true;if(typeof t.hash=="undefined")t.hash=true;for(h=0;h<14;h++){if(h==9){continue}if(h==12&&!t.query){continue}if(h==13&&!t.hash){continue}if(n[r[h]])a[r[h]]=n[r[h]]}if(t.query&&n[r[12]]){a[o[0]]=n[o[0]];a[o[1]]=n[o[1]]}for(h=0;h<l;h++){u=f[h];if(u=="."){i[s]=""}else if(u==".."){i[--s]=""}else if(u===""){if(l>1){if(h==0){i[0]=u;s=1}if(h==l-1)i[s]=u}}else{i[s]=u;if(h<l-1)s++}}var d=a[r[9]]=i.slice(0,s+1).join("/"),p=d.split(/\//),g=[d];if(a[r[12]])g.push("?",a[r[12]]);if(a[r[13]])g.push("#",a[r[13]]);a[r[8]]=g.join("");a[r[10]]=p.slice(0,p.length-1).join("/")+"/";a[r[11]]=p[p.length-1];return a},d=function(e){var t=this,a=t[o[0]],i=t[o[1]],r=[],f,l;for(f in e){l=e[f];if(l===null){delete a[f];delete i[f]}else if(n(l)){}else{a[f]=l;i[f]=[l]}}for(f in a){r.push(s(f)+"="+s(a[f]))}t.search=r.join("&");return t};a.csv=function(e,t){t=t||{};var a=t.lineterminator||"\n",i=t.delimiter||",",s=0,r=e.length,o,f,l,c,h,u=[],d={},p=0,g=new RegExp('("|'+i+"|\n)","g");if(r==0){}else if(n(e[0])){for(;s<r;s++){l=e[s];f=l.length;for(o=0;o<f;o++){c=String(l[o]).replace(/"/g,'""');if(c.search(g)>=0)c='"'+c+'"';if(o>0)c=i+c;u.push(c)}u.push(a)}}else{for(;s<r;s++){l=e[s];h=[];for(o in l){c=String(l[o]).replace(/"/g,'""');if(c.search(g)>=0)c='"'+c+'"';if(!(o in d))d[o]=p++;h[d[o]]=c}u.push(h.join(i));u.push(a)}h=[];for(o in d){c=String(o).replace(/"/g,'""');if(c.search(g)>=0)c='"'+c+'"';h.push(c)}u.unshift(a);u.unshift(h.join(i))}return u.join("")};function p(e,t){var a=-1,i,s;if(!e.cssRules)return;s=e.cssRules.length;while(++a<s){i=e.cssRules[a];if(i.type==3)p(i.styleSheet,t);else if(i.selectorText&&i.selectorText.indexOf(">")==-1)t.push(i.cssText)}}a.download=function(t){var i=t.mime,s=t.text,n="http://www.w3.org/2000/xmlns/",r=e.navigator,o=-1,f,l,c,h,u,d,m;if(t.svg){i=i||"application/svg;charset=utf-8";u=g(t.svg).get(0);if(!u.hasAttributeNS(n,"xmlns"))u.setAttributeNS(n,"xmlns","http://www.w3.org/2000/svg");if(!u.hasAttributeNS(n,"xmlns:xlink"))u.setAttributeNS(n,"xmlns:xlink","http://www.w3.org/1999/xlink");if(!s){f=e.document.styleSheets||[];c=[];l=f.length;o=-1;while(++o<l)if(f[o])p(f[o],c);s=(new XMLSerializer).serializeToString(g(t.svg).get(0));if(c.length)s=s.replace(/>/,"><defs><style><![CDATA["+c.join("\n")+"]]></style></defs>");s='<?xml version="1.0" standalone="no"?>'+s}}else if(t.csv){i=i||"text/csv;charset-utf-8";s=a.csv(t.csv)}h=new Blob([s],{type:i});if(r.msSaveOrOpenBlob&&r.msSaveOrOpenBlob.bind(r))return r.msSaveOrOpenBlob(h,t.file);d=e.URL.createObjectURL(h);m=g("<a></a>").attr("download",t.file).attr("href",d).css("display","none").appendTo("body").dispatch("click");setTimeout(function(){m.remove();e.URL.revokeObjectURL(d)},10)};var g=e.jQuery,m=g;if(g){function v(e,t){return e.filter(t).add(e.find(t))}function y(e,t){return e.not(t).add(e.not(t))}var w=/[\t\r\n\f]/g,x=/\S+/g;g.fn.addClass=function(e){var t,a,i,s,n,r,o,f=0,l=this.length,c=typeof e==="string"&&e;if(m.isFunction(e)){return this.each(function(t){m(this).addClass(e.call(this,t,typeof this.className=="object"?this.className.baseVal:this.className))})}if(c){t=(e||"").match(x)||[];for(;f<l;f++){a=this[f];r=typeof a.className=="object";o=r?a.className.baseVal:a.className;i=a.nodeType===1&&(o?(" "+o+" ").replace(w," "):" ");if(i){n=0;while(s=t[n++]){if(i.indexOf(" "+s+" ")<0){i+=s+" "}}if(r){a.className.baseVal=m.trim(i)}else{a.className=m.trim(i)}}}}return this};g.fn.removeClass=function(e){var t,a,i,s,n,r,o,f=0,l=this.length,c=arguments.length===0||typeof e==="string"&&e;if(m.isFunction(e)){return this.each(function(t){m(this).removeClass(e.call(this,t,typeof this.className=="object"?this.className.baseVal:this.className))})}if(c){t=(e||"").match(x)||[];for(;f<l;f++){a=this[f];r=typeof a.className=="object";o=r?a.className.baseVal:a.className;i=a.nodeType===1&&(o?(" "+o+" ").replace(w," "):"");if(i){n=0;while(s=t[n++]){while(i.indexOf(" "+s+" ")>=0){i=i.replace(" "+s+" "," ")}}if(r){a.className.baseVal=e?m.trim(i):""}else{a.className=e?m.trim(i):""}}}}return this};g.fn.toggleClass=function(e,t){var a=typeof e;if(typeof t==="boolean"&&a==="string"){return t?this.addClass(e):this.removeClass(e)}if(m.isFunction(e)){return this.each(function(a){m(this).toggleClass(e.call(this,a,typeof this.className=="object"?this.className.baseVal:this.className,t),t)})}return this.each(function(){var t,i;if(a==="string"){var s,n=0,r=m(this),o=e.match(x)||[];while(s=o[n++]){if(r.hasClass(s)){r.removeClass(s)}else{r.addClass(s)}}}else if(a===core_strundefined||a==="boolean"){t=typeof this.className=="object";i=t?this.className.baseVal:this.className;if(i){data_priv.set(this,"__className__",i)}if(t){this.className.baseVal=this.className.baseVal||e===false?"":data_priv.get(this,"__className__")||""}else{this.className=this.className||e===false?"":data_priv.get(this,"__className__")||""}}})};g.fn.hasClass=function(e){var t=" "+e+" ",a,i=0,s=this.length;for(;i<s;i++){a=this[i].className;if(this[i].nodeType===1&&(" "+(typeof a=="object"?a.baseVal:a)+" ").replace(w," ").indexOf(t)>=0){return true}}return false};g.fn.aspect=function(e){e=e||{};var t,a=this,i=e.width,s=e.height,n=a[0].ownerDocument,r=g(n.defaultView||n.parentWindow);if(e.off){r.off(".aspect");return a}function t(){(e.selector?v(a,e.selector):a).each(function(){var e=this.getBoundingClientRect(),t=g(this),a=t.data("width")||i,n=t.data("height")||s;if(n)t.css("height",Math.ceil(n*e.width));else if(a)t.css("width",Math.ceil(a*e.height))})}r.on("resize.aspect",t).on("orientationchange.aspect",t);t();return a};var b;try{new Event("click");b=function(e,t){if(e.match(/click$|^mouse|^menu$/))return new MouseEvent(e,t);else if(e.match(/^key/))return new KeyboardEvent(e,t);else if(e.match(/^focus|^blur$/))return new FocusEvent(e,t);else return new Event(e,t)}}catch(C){b=function(e,t){var a=document.createEvent("event");a.initEvent(e,t.bubbles,t.cancelable);return a}}g.fn.dispatch=function(e,t){return this.each(function(){this.dispatchEvent(b(e,g.extend({bubbles:true,cancelable:true},t)))})};g.fn.urlfilter=function(e){e=e||{};var t=this,i=e.attr||"href",s=e.selector||"["+i+"]",n="remove"in e?e.remove:true,r=t[0].ownerDocument,f=(r.defaultView||r.parentWindow).location,l=e.target;if(e.off)return t.off("click.urlfilter");return t.on("click.urlfilter",s,function(e){e.preventDefault();var t=g(this),s=t.data("target")||l,r=t.attr(i),c=a.url.parse(r)[o[0]],h,u,d;if(n)for(d in c)if(c[d]==="")c[d]=null;if(!s)u=f.href;else if(s=="#")u=f.hash.replace(/^#/,"");else{h=g(s);u=h.data("src")}u=a.url.parse(u).join(r,{query:false,hash:false}).update(c);if(!s)f.href=u;else if(s=="#")f.hash=u;else h.data("src",u).load(u.toString())})};g.fn.highlight=function(e){e=e||{};var t=this,a=e.attr||"data-highlight",i=e.selector||"["+a+"]",s=e.leaveDelay||30,n=e.toggle,r,o=[];if(e.off)return t.off(".highlight");function f(t,s){var n=g(s),r=g(n.data("target")||e.target||i),o=n.data("hide-class")||e.hideClass||"fade",f=n.data("show-class")||e.showClass||"",l=g(),c,h=t.length;if(h==0){if(f)v(r,"."+f).removeClass(f);if(o)v(r,"."+o).removeClass(o);return}while(h--)l=l.add(v(r,g(t[h]).attr(a)));c=r.not(l);if(f){y(l,"."+f).addClass(f);v(c,"."+f).removeClass(f)}if(o){v(l,"."+o).removeClass(o);y(c,"."+o).addClass(o)}}t.on("mouseenter.highlight",i,function(e){if(r)r=clearTimeout(r);if(!o.length)f([e.target],this)}).on("mouseleave.highlight",i,function(e){if(r)r=clearTimeout(r);var t=this;if(!o.length)r=setTimeout(function(){f([],t)},s)}).on("click.highlight",i,function(e){var t=g(this),a;if(t.data("toggle")||n){a=o.indexOf(e.target);if(a>=0){o.splice(a,1);t.removeClass("active")}else{o.push(e.target);t.addClass("active")}f(o,this)}});return t};g.fn.panzoom=function(e){e=e||{};var t=this,a=e.attr||"data-zoom",i=e.selector||"["+a+"]",s=e.target,n=e.zoom||4;if(e.off)return t.off("click.panzoom");t.on("click",i,function(e){var t=g(this),i=t.data("target")||s,r=t.attr(a)||n,o=g(i);function f(e){o.each(function(){this.setAttribute("viewBox",this.getAttribute("data-viewBox"))})}function l(e){o.each(function(){var t=this.getAttribute("data-viewBox"),a=t.split(/,|\s+/),i=this.getBoundingClientRect(),s=+a[2]||i.width,n=+a[3]||i.height;this.setAttribute("viewBox",[e.offsetX,e.offsetY,s/r,n/r].join(" "))})}if(t.is(".active")){t.removeClass("active");f();o.off(".panzoom").each(function(){this.removeAttribute("data-viewBox")})}else{o.each(function(){this.setAttribute("data-viewBox",this.getAttribute("viewBox")||"")}).on("mousemove.panzoom",l).on("mouseleave.panzoom",f);l({offsetX:0,offsetY:0});t.addClass("active")}});return t};g.fn.reveal=function(e){e=e||{};var t=this,a=e.attr||"data-reveal",i=e.selector||"["+a+"]",s={};if(e.off)return t.off(".reveal");g(i).each(function(){var t=g(this),a=t.data("target")||e.target||i,n,r,o,f;if(!s[a]){n=+(t.data("start")||e.start||1);o=t.data("hide-class")||e.hideClass||"fade";f="."+o;r=g(a);r.eq(n-1).filter(f).removeClass(o);r.slice(n).not(f).addClass(o);s[a]=1}});return t.on("click.reveal",i,function(t){var s=g(this),n=g(s.data("target")||e.target||i),r=s.data("hide-class")||e.hideClass||"fade",o="."+r,f=s.attr(a);if(f.match(/next/i)){n.filter(o).first().removeClass(r)}else if(f.match(/prev/i)){n.not(o).last().addClass(r)}else{f=+f;if(f<0)f=n.length+f+1;console.log(f);n.slice(0,f).filter(o).removeClass(r);n.slice(f).not(o).addClass(r)}})};function N(e){return(e||"").toLowerCase().replace(/\s+/g," ").replace(/^ /,"").replace(/ $/,"")}g.fn.search=function(e){e=e||{};var t=this,a=e.attr||"data-search",i=e.selector||"["+a+"]",s=e.transform||N,n=e.showClass||"",r=e.hideClass||"fade",o="search-lastsearch",f="search-mapping";if(e.off)return t.off(".search");function l(t){var i=g(t.target),n=[],r=e.text||i.attr(a),o=g(i.data("target")||e.target||(typeof r=="string"?"["+r+"]":"*"));o.each(typeof r=="function"?function(){var e=r(this);n.push([g(this),e,s(e),false])}:function(){var e=this.getAttribute(r);n.push([g(this),e,s(e),false])});i.data(f,n);return n}function c(e){var t=e.target,a=g(t),i=s(t.value);if(a.data(o)==i)return;var n=a.data(f),c=new RegExp(i),h=a.data("hide-class")||r,u=0,d;a.data(o,i);if(!n)n=l(e);for(;d=n[u];u++){var p=!d[2].match(c);if(p!==d[3]){d[3]=p;d[0][p?"addClass":"removeClass"](h)}}}return t.on("keyup.search",i,c).on("change.search",i,c).on("refresh.search",l)}}a.unpack=function(){var e,t,a;function i(i){var s=i.data(),n=-1,r=s.length;while(++n<r){s[n].x0=s[n].x;s[n].y0=s[n].y}function o(e){return function(t){t.x+=(t.x0-t.x)*e;t.y+=(t.y0-t.y)*e}}function f(e){var t=d3.geom.quadtree(s);return function(a){var i=a.r,s=a.x-i,n=a.x+i,r=a.y-i,o=a.y+i;t.visit(function(t,f,l,c,h){if(t.point&&t.point!==a){var u=a.x-t.point.x,d=a.y-t.point.y,p=u*u+d*d,g=i+t.point.r;if(p<g*g){p=((p=Math.sqrt(p))-g)/p*e;a.x-=u*=p;a.y-=d*=p;t.point.x+=u;t.point.y+=d}}return f>n||c<s||l>o||h<r})}}e.size([t,a]).nodes(s).on("tick",function l(e){i.each(o(e.alpha*.1)).each(f(.5)).attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}).start()}i.width=function(e){if(!arguments.length)return t;t=e;return i};i.height=function(e){if(!arguments.length)return a;a=e;return i};i.force=function(t){if(!arguments.length)return e;e=t;return i};return i.force(d3.layout.force().charge(0).gravity(.01))};a.map=function(){var e,t,i,s,n,r={};function o(){s.scale(1).translate([0,0]);var a=n.bounds(e),r=.95/Math.max((a[1][0]-a[0][0])/t,(a[1][1]-a[0][1])/i),o=[(t-r*(a[1][0]+a[0][0]))/2,(i-r*(a[1][1]+a[0][1]))/2];s.scale(r).translate(o)}r.map=function(t){o();var a=t.selectAll("path.map").data(e.features);a.transition().attr("transform",null).attr("d",n);a.enter().append("path").attr("class","map").attr("transform",null).attr("d",n);a.exit().remove();return a};r.dorling=function(s){o();var r="M0,0m-4,0a4,4 0 1,0 8,0a4,4 0 1,0 -8,0",f=e.features.map(function(e){var t=n.centroid(e.geometry);return typeof t==="undefined"?{x:0,y:0}:{x:t[0],y:t[1],x0:t[0],y0:t[1],r:5,properties:e.properties}}),l;l=s.selectAll("path.map").data(f);l.transition().attr("d",r);l.enter().append("path").attr("class","map").attr("d",r);l.exit().remove();a.unpack().width(t).height(i)(l);return l};r.shape=function(t){if(!arguments.length)return e;e=t;return r};r.width=function(e){if(!arguments.length)return t;t=e;return r};r.height=function(e){if(!arguments.length)return i;i=e;return r};r.force=function(e){if(!arguments.length)return force;force=e;return r};r.path=function(e){if(!arguments.length)return n;n=e;return r};r.projection=function(e){if(!arguments.length)return s;s=e;n=d3.geo.path().projection(e);return r};return r.projection(d3.geo.mercator()).force(d3.layout.force().charge(0).gravity(.01))};a.url={parse:c,unparse:h}})(this);