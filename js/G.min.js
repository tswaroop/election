(function(e){"use strict";var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,a=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return false}}(),i=a&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch(e){return false}}(),n=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,s=(a||n)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,s,r,o,l,f;if(e.split(",")[0].indexOf("base64")>=0){t=atob(e.split(",")[1])}else{t=decodeURIComponent(e.split(",")[1])}s=new ArrayBuffer(t.length);r=new Uint8Array(s);for(o=0;o<t.length;o+=1){r[o]=t.charCodeAt(o)}l=e.split(",")[0].split(":")[1].split(";")[0];if(a){return new Blob([i?r:s],{type:l})}f=new n;f.append(s);return f.getBlob(l)};if(e.HTMLCanvasElement&&!t.toBlob){if(t.mozGetAsFile){t.toBlob=function(e,a,i){if(i&&t.toDataURL&&s){e(s(this.toDataURL(a,i)))}else{e(this.mozGetAsFile("blob",a))}}}else if(t.toDataURL&&s){t.toBlob=function(e,t,a){e(s(this.toDataURL(t,a)))}}}if(typeof define==="function"&&define.amd){define(function(){return s})}else{e.dataURLtoBlob=s}})(this);(function(e,t){var a=e.G=typeof exports=="undefined"?{}:exports;a.version="0.0.8";var i=decodeURIComponent,n=encodeURIComponent,s="http://www.w3.org/2000/xmlns/",r="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xlink",l=Array.isArray,f=e.URL||e.webkitURL;var c=["href","protocol","origin","userInfo","username","password","hostname","port","relative","pathname","directory","file","search","hash"],h=["searchKey","searchList"],u=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,d=/(?:^|&)([^&=]*)=?([^&]*)/g,g=function(e){var t={toString:p,join:m,update:v},a=u.exec(e||""),n=14;while(n--)t[c[n]]=a[n]||"";var s=t[h[0]]={},r=t[h[1]]={};t[c[12]].replace(d,function(e,t,a){if(t){t=i(t);a=i(a);s[t]=a;(r[t]=r[t]||[]).push(a)}});return t},p=function(e){e=e||this;var t=e[c[1]]||"http",a=e[c[4]],i=e[c[5]],s=e[c[6]],r=e[c[7]],o=e[c[9]],l=e[c[12]],f=e[c[13]],u=e[h[0]],d=e[h[1]],g=s?[t,"://"]:[],p=[],m,v,y,b;if(a){g.push(a);if(i)g.push(":",i);g.push("@")}g.push(s);if(r)g.push(":",r);g.push(o||(s?"/":""));if(l){g.push("?",l)}else{if(u){for(m in u){p.push(n(m)+"="+n(u[m]))}}else if(d){for(m in d){for(y=0,v=d[m],b=v.length;y<b;y++){p.push(n(m)+"="+n(v[y]))}if(!b)p.push(m)}}if(p.length)g.push("?",p.join("&"))}if(f)g.push("#",f);return g.join("")},m=function(e,t){t=t||{};var a=this,i=a[c[9]].split("/"),n=i.length-1,s=g(e),r=s.pathname.split("/"),o=r.length,l,f;if(typeof t.query=="undefined")t.query=true;if(typeof t.hash=="undefined")t.hash=true;for(l=0;l<14;l++){if(l==9){continue}if(l==12&&!t.query){continue}if(l==13&&!t.hash){continue}if(s[c[l]])a[c[l]]=s[c[l]]}if(t.query&&s[c[12]]){a[h[0]]=s[h[0]];a[h[1]]=s[h[1]]}for(l=0;l<o;l++){f=r[l];if(f=="."){i[n]=""}else if(f==".."){i[--n]=""}else if(f===""){if(o>1){if(!l){i[0]=f;n=1}if(l==o-1)i[n]=f}}else{i[n]=f;if(l<o-1)n++}}var u=a[c[9]]=i.slice(0,n+1).join("/"),d=u.split(/\//),p=[u];if(a[c[12]])p.push("?",a[c[12]]);if(a[c[13]])p.push("#",a[c[13]]);a[c[8]]=p.join("");a[c[10]]=d.slice(0,d.length-1).join("/")+"/";a[c[11]]=d[d.length-1];return a},v=function(e){var t=this,a=t[h[0]],i=t[h[1]],s=[],r,o;for(r in e){o=e[r];if(o===null){delete a[r];delete i[r]}else if(l(o)){}else{a[r]=o;i[r]=[o]}}for(r in a){s.push(n(r)+"="+n(a[r]))}t.search=s.join("&");return t};a.csv=function(e,t){t=t||{};var a=t.lineterminator||"\n",i=t.delimiter||",",n=0,s=e.length,r,o,f,c,h,u=[],d={},g=0,p=new RegExp('("|'+i+"|\n)","g");if(!s){}else if(l(e[0])){for(;n<s;n++){f=e[n];o=f.length;for(r=0;r<o;r++){c=String(f[r]).replace(/"/g,'""');if(c.search(p)>=0)c='"'+c+'"';if(r>0)c=i+c;u.push(c)}u.push(a)}}else{for(;n<s;n++){f=e[n];h=[];for(r in f){c=String(f[r]).replace(/"/g,'""');if(c.search(p)>=0)c='"'+c+'"';if(!(r in d))d[r]=g++;h[d[r]]=c}u.push(h.join(i));u.push(a)}h=[];for(r in d){c=String(r).replace(/"/g,'""');if(c.search(p)>=0)c='"'+c+'"';h.push(c)}u.unshift(a);u.unshift(h.join(i))}return u.join("")};function y(e,t){var a=-1,i,n;if(!e.cssRules)return;n=e.cssRules.length;while(++a<n){i=e.cssRules[a];if(i.type==3)y(i.styleSheet,t);else if(i.selectorText&&i.selectorText.indexOf(">")==-1)t.push(i.cssText)}}function b(t,a){var i=e.navigator,n,s;if(i.msSaveOrOpenBlob&&i.msSaveOrOpenBlob.bind(i))return i.msSaveOrOpenBlob(t,a.file);n=f.createObjectURL(t);s=w("<a></a>").attr("download",a.file).attr("href",n).css("display","none").appendTo("body").dispatch("click");setTimeout(function(){s.remove();f.revokeObjectURL(n)},10)}a.download=function(t){var i=t.mime,n=t.source,l=-1,c,h,u,d,g,p,m,v,C,x,N;if(t.svg){i=i||"application/svg;charset=utf-8";p=w(t.svg).get(0);if(!p.hasAttributeNS(s,"xmlns"))p.setAttributeNS(s,"xmlns",r);if(!p.hasAttributeNS(s,"xmlns:xlink"))p.setAttributeNS(s,"xmlns:xlink",o);if(!n){n=(new XMLSerializer).serializeToString(w(t.svg).get(0));if(!t.nostyle){c=e.document.styleSheets||[];u=[];h=c.length;l=-1;while(++l<h)if(c[l])y(c[l],u);if(u.length)n=n.replace(/>/,"><defs><style><![CDATA["+u.join("\n")+"]]></style></defs>")}n='<?xml version="1.0" standalone="no"?>'+n}b(new Blob([n],{type:i}),t)}else if(t.png){i=i||"image/png";d=new Image;v=w(t.png).get(0);n=(new XMLSerializer).serializeToString(v);g=new Blob([n],{type:"image/svg+xml;charset-utf-8"});m=f.createObjectURL(g);C=v.getBoundingClientRect();d.onload=function(){x=w("<canvas></canvas>").attr("width",t.width||C.width).attr("height",t.height||C.height).appendTo("body").css("display","none").get(0);N=x.getContext("2d");N.drawImage(d,0,0);x.toBlob(function(e){b(e,t);w(x).remove()},i)};d.src=m}else if(t.csv){i=i||"text/csv;charset-utf-8";n=a.csv(t.csv);b(new Blob([n],{type:i}),t)}else{i=i||"text/html;charset-utf-8";b(new Blob([t.source],{type:i}),t)}};a.zoom=function(e){e=e||{};var t=e.selector,a=d3.select(t),i=d3.selectAll(a.node().children),n=d3.behavior.zoom().on("zoom",function(){i.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")");d3.event.sourceEvent.stopPropagation()});if(e.off){a.on(".zoom",null);i.classed("zoom",true).transition().attr("transform","");return}a.call(n).classed("zoom",false)};var w=e.jQuery,C=w,x=function(e,t){return e.filter(t).add(e.find(t))},N=function(e,t){return e.not(t).add(e.not(t))};getSize=function(e){var t=w(e);t.css("display","block");return{width:t.width(),height:t.height()}};if(w){var B=/[\t\r\n\f]/g,j=/\S+/g;w.fn.addClass=function(e){var t,a,i,n,s,r,o,l=0,f=this.length,c=typeof e==="string"&&e;if(C.isFunction(e)){return this.each(function(t){C(this).addClass(e.call(this,t,typeof this.className=="object"?this.className.baseVal:this.className))})}if(c){t=(e||"").match(j)||[];for(;l<f;l++){a=this[l];r=typeof a.className=="object";o=r?a.className.baseVal:a.className;i=a.nodeType===1&&(o?(" "+o+" ").replace(B," "):" ");if(i){s=0;while(n=t[s++]){if(i.indexOf(" "+n+" ")<0){i+=n+" "}}if(r){a.className.baseVal=C.trim(i)}else{a.className=C.trim(i)}}}}return this};w.fn.removeClass=function(e){var t,a,i,n,s,r,o,l=0,f=this.length,c=arguments.length===0||typeof e==="string"&&e;if(C.isFunction(e)){return this.each(function(t){C(this).removeClass(e.call(this,t,typeof this.className=="object"?this.className.baseVal:this.className))})}if(c){t=(e||"").match(j)||[];for(;l<f;l++){a=this[l];r=typeof a.className=="object";o=r?a.className.baseVal:a.className;i=a.nodeType===1&&(o?(" "+o+" ").replace(B," "):"");if(i){s=0;while(n=t[s++]){while(i.indexOf(" "+n+" ")>=0){i=i.replace(" "+n+" "," ")}}if(r){a.className.baseVal=e?C.trim(i):""}else{a.className=e?C.trim(i):""}}}}return this};w.fn.toggleClass=function(e,t){var a=typeof e;if(typeof t==="boolean"&&a==="string"){return t?this.addClass(e):this.removeClass(e)}if(C.isFunction(e)){return this.each(function(a){C(this).toggleClass(e.call(this,a,typeof this.className=="object"?this.className.baseVal:this.className,t),t)})}return this.each(function(){var t,i;if(a==="string"){var n,s=0,r=C(this),o=e.match(j)||[];while(n=o[s++]){if(r.hasClass(n)){r.removeClass(n)}else{r.addClass(n)}}}else if(a===core_strundefined||a==="boolean"){t=typeof this.className=="object";i=t?this.className.baseVal:this.className;if(i){data_priv.set(this,"__className__",i)}if(t){this.className.baseVal=this.className.baseVal||e===false?"":data_priv.get(this,"__className__")||""}else{this.className=this.className||e===false?"":data_priv.get(this,"__className__")||""}}})};w.fn.hasClass=function(e){var t=" "+e+" ",a,i=0,n=this.length;for(;i<n;i++){a=this[i].className;if(this[i].nodeType===1&&(" "+(typeof a=="object"?a.baseVal:a)+" ").replace(B," ").indexOf(t)>=0){return true}}return false};w.fn.aspect=function(e){e=e||{};var t,a=this,i=e.width,n=e.height,s=a[0].ownerDocument,r=w(s.defaultView||s.parentWindow);if(e.off){r.off(".g.aspect");return a}t=function(){(e.selector?x(a,e.selector):a).each(function(){var e=w(this),t=e.data("width")||i,a=e.data("height")||n,s=getSize(this);if(a)e.css("height",Math.ceil(a*s.width));else if(t)e.css("width",Math.ceil(t*s.height))})};r.on("resize.g.aspect",t).on("orientationchange.g.aspect",t);t();return a};var z;try{new Event("click");z=function(e,t){if(e.match(/click$|^mouse|^menu$/))return new MouseEvent(e,t);else if(e.match(/^key/))return new KeyboardEvent(e,t);else if(e.match(/^focus|^blur$/))return new FocusEvent(e,t);else return new Event(e,t)}}catch(A){z=function(e,t){var a=document.createEvent("event");a.initEvent(e,t.bubbles,t.cancelable);return a}}w.fn.dispatch=function(e,t){return this.each(function(){this.dispatchEvent(z(e,w.extend({bubbles:true,cancelable:true},t)))})};w.fn.urlfilter=function(e){e=e||{};var t=this,i=e.attr||"href",n=e.selector||"["+i+"]",s="remove"in e?e.remove:true,r=t[0].ownerDocument,o=(r.defaultView||r.parentWindow).location,l=e.target;if(e.off)return t.off("click.urlfilter");return t.on("click.urlfilter",n,function(e){e.preventDefault();var t=w(this),n=t.data("target")||l,r=t.attr(i),f=a.url.parse(r)[h[0]],c,u,d;if(s)for(d in f)if(f[d]==="")f[d]=null;if(!n)u=o.href;else if(n=="#")u=o.hash.replace(/^#/,"");else{c=w(n);u=c.data("src")}u=a.url.parse(u).join(r,{query:false,hash:false}).update(f);if(!n)o.href=u;else if(n=="#")o.hash=u;else c.data("src",u).load(u.toString())})};w.fn.highlight=function(e){e=e||{};var t=this,a=e.attr||"data-highlight",i=e.selector||"["+a+"]",n=e.leaveDelay||30,s=e.toggle,r,o=[];if(e.off)return t.off(".g.highlight");function l(n,s){var r=w(s),o=w(r.data("target")||e.target||i),l=r.data("hide-class")||e.hideClass||"fade",f=r.data("show-class")||e.showClass||"",c=w(),h,u=n.length,d=u;if(u){while(d--)c=c.add(x(o,w(n[d]).attr(a)));h=o.not(c);if(f){N(c,"."+f).addClass(f);x(h,"."+f).removeClass(f)}if(l){x(c,"."+l).removeClass(l);N(h,"."+l).addClass(l)}}else{if(f)x(o,"."+f).removeClass(f);if(l)x(o,"."+l).removeClass(l)}t.trigger({type:"shown.g.highlight",selected:w(n),matches:(u?c:o).length})}t.on("mouseenter.g.highlight",i,function(e){if(r)r=clearTimeout(r);if(!o.length)l([e.target],this)}).on("mouseleave.g.highlight",i,function(e){if(r)r=clearTimeout(r);var t=this;if(!o.length)r=setTimeout(function(){l([],t)},n)}).on("click.g.highlight",i,function(e){var t=w(this),a;if(t.data("toggle")||s){a=o.indexOf(e.target);if(a>=0){o.splice(a,1);t.removeClass("active")}else{o.push(e.target);t.addClass("active")}l(o,this)}});return t};w.fn.panzoom=function(t){t=t||{};var a=this,i=t.attr||"data-zoom",n=t.selector||"["+i+"]",s=t.target,r=t.zoom||4,o="viewBox",l="animated";if(t.off)return a.off("click.panzoom");a.on("click",n,function(t){var a=w(this),n=a.data("target")||s,f=a.attr(i)||r,c=w(n);function h(t){c.each(function(){var t=w(this).data(o);if(e.d3)d3.select(this).transition().duration(100).attr(o,t);else this.setAttribute(o,t)})}function u(t){c.each(function(){var a=w(this),i=a.data(o),n=this.getBoundingClientRect(),s=+i[2]||n.width,r=+i[3]||n.height,c=a.offset(),h=t.pageX-c.left,u=t.pageY-c.top,d=[h,u,s/f,r/f].join(" ");if(e.d3&&!t.type.match(/move/)){a.data(l,true);d3.select(this).transition().duration(100).attr(o,d).each("end",function(){a.data(l,false)})}else if(!a.data(l))this.setAttribute(o,d)})}if(a.is(".active")){h();c.off(".panzoom").each(function(){w(this).removeData(o)})}else{c.each(function(){w(this).data(o,(this.getAttribute(o)||"").split(/,|\s+/))}).on("mousemove.panzoom",u);u(t)}a.toggleClass("active")});return a};w.fn.reveal=function(e){e=e||{};var t=this,a=e.attr||"data-reveal",i=e.selector||"["+a+"]",n={};if(e.off)return t.off(".g.reveal");w(i).each(function(){var t=w(this),a=t.data("target")||e.target||i,s,r,o,l,f;if(!n[a]){s=+(t.data("start")||e.start||0);l=t.data("hide-class")||e.hideClass||"fade";o=t.data("type")||e.type||"overlay";f="."+l;r=w(a);if(o=="overlay"){r.eq(s).filter(f).removeClass(l);r.slice(s+1).not(f).addClass(l)}else if(o=="single"){r.eq(s).filter(f).removeClass(l);r.not(r.eq(s)).not(f).addClass(l)}n[a]=1}});return t.on("click.g.reveal",i,function(t){var n=w(this),s=w(n.data("target")||e.target||i),r=n.data("hide-class")||e.hideClass||"fade",o=n.data("type")||e.type||"overlay",l=n.data("loop")||e.loop,f="."+r,c=n.attr(a),h,u,d,g,p;if(o=="overlay"){if(c.match(/next/i)){h=s.filter(f);if(!h.length){if(l){s.slice(1).addClass(r);d=s.eq(0)}else{d=s.last()}}else{d=h.first().removeClass(r)}g=s.index(d)}else if(c.match(/prev/i)){u=s.not(f);if(u.length<=1){if(l){s.removeClass(r);d=s.last()}}else{u.last().addClass(r);d=u.eq(-2)}g=s.index(d)}else{g=+c;if(g<0)g=s.length+g;s.slice(0,g+1).filter(f).removeClass(r);s.slice(g+1).not(f).addClass(r)}}else if(o=="single"){p=s.length;u=s.not(f);if(c.match(/next/i)){if(u.length){g=s.index(u.last())+1;if(g>=p)g=l?0:p-1}else g=0}else if(c.match(/prev/i)){if(u.length){g=s.index(u.last())-1;if(g<0)g=l?p-1:0}else g=p-1}else g=+c;d=s.eq(g);d.filter(f).removeClass(r);s.not(d).not(f).addClass(r)}n.trigger({type:"shown.g.reveal",slide:g})})};var S=function(e){return(e||"").toLowerCase().replace(/\s+/g," ").replace(/^ /,"").replace(/ $/,"")};w.fn.search=function(e){e=e||{};var t=this,a=e.attr||"data-search",i=e.selector||"["+a+"]",n=e.transform||S,s=e.showClass||"",r=e.hideClass||"",o="search-lastsearch",l="search-mapping",f,c;if(e.off)return t.off(".g.search");f=function(t){var i=w(t.target),s=[],r=e.text||i.attr(a),o=w(i.data("target")||e.target||(typeof r=="string"?"["+r+"]":"*"));o.each(typeof r=="function"?function(){var e=r(this);s.push([w(this),e,n(e),false])}:function(){var e=this.getAttribute(r);s.push([w(this),e,n(e),false])});i.data(l,s);return s};c=function(e){var t=w(e.target),a=t.val(),i=n(a),c=t.data(o);if(c==i)return;var h=t.data(l),u=new RegExp(i),d=t.data("show-class")||s,g=t.data("hide-class")||r||(d?"":"fade"),p,m,v;t.data(o,i);if(!h)h=f(e);v=h.length;if(!i.length){for(p=0;m=h[p];p++){if(m[3]){if(g)m[0].removeClass(g)}else{if(d)m[0].removeClass(d)}m[3]=false}}else{for(p=0;m=h[p];p++){var y=!m[2].match(u);if(y!==m[3]||!c){if(g)m[0][y?"addClass":"removeClass"](g);if(d)m[0][!y?"addClass":"removeClass"](d);m[3]=y}if(y)v--}}t.trigger({type:"shown.g.search",searchText:a,search:i,matches:v})};return t.on("keyup.g.search",i,c).on("change.g.search",i,c).on("refresh.g.search",f)}}a.unpack=function(){var e,t,a;function i(i){var n=i.data(),s=-1,r=n.length;while(++s<r){n[s].x0=n[s].x;n[s].y0=n[s].y}function o(e){return function(t){t.x+=(t.x0-t.x)*e;t.y+=(t.y0-t.y)*e}}function l(e){var t=d3.geom.quadtree(n);return function(a){var i=a.r,n=a.x-i,s=a.x+i,r=a.y-i,o=a.y+i;t.visit(function(t,l,f,c,h){if(t.point&&t.point!==a){var u=a.x-t.point.x,d=a.y-t.point.y,g=u*u+d*d,p=i+t.point.r;if(g<p*p){g=((g=Math.sqrt(g))-p)/g*e;a.x-=u*=g;a.y-=d*=g;t.point.x+=u;t.point.y+=d}}return l>s||c<n||f>o||h<r})}}e.size([t,a]).nodes(n).on("tick",function f(e){i.each(o(e.alpha*.1)).each(l(.5)).attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}).start()}i.width=function(e){if(!arguments.length)return t;t=e;return i};i.height=function(e){if(!arguments.length)return a;a=e;return i};i.force=function(t){if(!arguments.length)return e;e=t;return i};return i.force(d3.layout.force().charge(0).gravity(.01))};a.map=function(){var e,t,i,n,s,r={};function o(){n.scale(1).translate([0,0]);var a=s.bounds(e),r=.95/Math.max((a[1][0]-a[0][0])/t,(a[1][1]-a[0][1])/i),o=[(t-r*(a[1][0]+a[0][0]))/2,(i-r*(a[1][1]+a[0][1]))/2];n.scale(r).translate(o)}r.map=function(t){o();var a=t.selectAll("path.map").data(e.features);a.transition().attr("transform",null).attr("d",s);a.enter().append("path").attr("class","map").attr("transform",null).attr("d",s);a.exit().remove();return a};r.dorling=function(n){o();var r="M0,0m-4,0a4,4 0 1,0 8,0a4,4 0 1,0 -8,0",l=e.features.map(function(e){var t=s.centroid(e.geometry);return typeof t==="undefined"?{x:0,y:0}:{x:t[0],y:t[1],x0:t[0],y0:t[1],r:5,properties:e.properties}}),f;f=n.selectAll("path.map").data(l);f.transition().attr("d",r);f.enter().append("path").attr("class","map").attr("d",r);f.exit().remove();a.unpack().width(t).height(i)(f);return f};r.shape=function(t){if(!arguments.length)return e;e=t;return r};r.width=function(e){if(!arguments.length)return t;t=e;return r};r.height=function(e){if(!arguments.length)return i;i=e;return r};r.force=function(e){if(!arguments.length)return force;force=e;return r};r.path=function(e){if(!arguments.length)return s;s=e;return r};r.projection=function(e){if(!arguments.length)return n;n=e;s=d3.geo.path().projection(e);return r};return r.projection(d3.geo.mercator()).force(d3.layout.force().charge(0).gravity(.01))};a.url={parse:g,unparse:p}})(this);